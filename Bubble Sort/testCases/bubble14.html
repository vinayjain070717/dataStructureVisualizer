<!doctype html>
<html lang='en'>

<head>
    <meta charset='utf-8'>
    <title>bubble Sort</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
    
     <!-- <link rel="stylesheet" href="css/bootstrap.min.css"> -->
     <style type="text/css">
        .invalidText {
            color: red;
            padding: 10px;
        }
        
        .slidecontainer {
            float: right;
        }
        
        .slider {
            -webkit-appearance: none;
            width: 200px;
            height: 6px;
            border-radius: 5px;
            background: #98FB98;
            outline: none;
            opacity: 0.7;
            -webkit-transition: .2s;
            transition: opacity .2s;
        }
        
        .slider:hover {
            opacity: 1;
        }
        .slider:disabled{
            background: #bbc7bb;
        }
        
        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 15px;
            height: 15px;
            border-radius: 50%;
            background: #235F2D;
            cursor: pointer;
        }
        
        .slider::-moz-range-thumb {
            width: 25px;
            height: 25px;
            border-radius: 50%;
            background: #4CAF50;
            cursor: pointer;
        }
        .slider:disabled::-webkit-slider-thumb{
            background: black;
        }

    </style>
    <script type="text/javascript">
        function startBlinking(xloc,yloc) //startBlinking(300,100,'16px arial')
        {
            // var c = document.getElementById("canvas1");
            var blinker = new Blinker(canvas, "|", 500, xloc, yloc,"16px arial");//"16px arial"
        }

        function Blinker(canvas, blinkingText, period, xloc, yloc,FONT)
        {
            this.textVisible = false;
            this.canvas = canvas;
            this.text = blinkingText;
            this.xloc = xloc;
            this.yloc = yloc;
            this.period = period;
            var self = this; // This is to pass the reference into setInterval
            this.interval = setInterval(function() { self.doBlink(); }, this.period);
            this.doBlink = function()
            {
                var context = this.canvas.getContext("2d");
                if(this.textVisible)
                {    
                    context.clearRect(0, 0, this.canvas.width, this.canvas.height);
                    this.textVisible = false;
                }
                else
                {
                    this.drawText();
                }
            };
            this.drawText = function()
            {
                var context = this.canvas.getContext("2d");
                context.font = FONT;
                context.fillText(this.text, this.xloc, this.yloc);
                this.textVisible = true;
            };
        }

        function TypingEffect(canvasContext,x,y,string,delay,style,color)
        {
            var string,x,y,delay,canvasContext;
            var j = 0;
            this.canvasContext=canvasContext;
            var THIS=this;
            this.makeTypingEffect=function(x,y,string,delay,style,color)
            {
                if(string) this.string=string;
                if(x) this.x=x;
                if(y) this.y=y;
                if(delay) this.delay=delay;
                else this.delay=100;
                if(style) this.style=style;
                else this.style="16px arial";
                if(color) this.color=color;
                else this.color="black";
                if (j < THIS.string.length) 
                {
                    THIS.canvasContext.font=THIS.style;
                    THIS.canvasContext.fillStyle=THIS.color;
                    // console.log("value of j is "+j);
                    // startBlinking(THIS.x,THIS.y);
                    // THIS.canvasContext.clearRect(THIS.x,THIS.y-15,10,20);
                    THIS.canvasContext.fillText(THIS.string.charAt(j),THIS.x,THIS.y);
                    THIS.x=THIS.x+THIS.canvasContext.measureText(THIS.string.charAt(j)).width;
                    // THIS.canvasContext.fillText("|",THIS.x,THIS.y);
                    // THIS.x=THIS.x+THIS.canvasContext.measureText("|").width;
                    setTimeout(function(){
                        // clearInterval(m);
                        THIS.makeTypingEffect(THIS.x,THIS.y,THIS.string,THIS.delay,THIS.style,THIS.color);
                    }, THIS.delay);
                    j++;
                    THIS.canvasContext.font="20px arial";
                    THIS.canvasContext.fillStyle="black";
                }
                // if(j==THIS.string.length)
                // {
                //     var i;
                //     m=setInterval(function(){
                //         i=0;
                //         if(i%2==0) THIS.canvasContext.fillText("|",THIS.x,THIS.y);
                //         else THIS.canvasContext.clearRect(THIS.x,THIS.y-15,10,20);
                //         i++;
                //     },THIS.delay/2);

                // }
            }

        }
    </script>
    <script>
        function checkSizeOfArrayOnInput() {
            var numberOfElements = document.getElementById("createArrayTextField").value;
            // console.log(numberOfElements);
            if (numberOfElements.length == 0) {
                document.getElementById("errorSpan").innerHTML = "Invalid Input";
                validate = false;
                return;
            }
            if (isNaN(numberOfElements)) {
                document.getElementById("errorSpan").innerHTML = "Invalid Input :Not a number";
                validate = false;
                return;
            } else {
                validate = true;
                document.getElementById("errorSpan").innerHTML = "";
                if (numberOfElements < 2) {
                    validate = false;
                    document.getElementById("errorSpan").innerHTML = "Invalid Input";
                } else {
                    validate = true;
                    document.getElementById("errorSpan").innerHTML = "";
                }
            }

        }

        function checkValueOfElementsOnInput() {
            var valueOfElements = document.getElementById("valueOfElementTextField").value;
            // console.log(valueOfElements);
            // console.log(valueOfElements.length);
            console.log(isNaN(valueOfElements));
            validate = true;
            document.getElementById("errorSpan").innerHTML = "";
            if (valueOfElements.length == 0) {
                validate = false;
                document.getElementById("errorSpan").innerHTML = "Enter some value";
            } else if (isNaN(valueOfElements)) {
                validate = false;
                document.getElementById("errorSpan").innerHTML = "Invalid Input :Not a number";
            } else {
                validate = true;
                document.getElementById("errorSpan").innerHTML = "";
            }
        }
    </script>
    <script>
        function Rectangle(x, y, width, height, value) {
            var value, x, y, width, height, color;
            if (value) this.value = value;
            if (x) this.x = x;
            if (y) this.y = y;
            else this.y = 30;
            if (width) this.width = width;
            else this.width = rectangleWidth;
            if (height) this.height = height;
            else this.height = 60;
            this.color = rectanglesColor;
            this.setX = function(X) {
                this.x = X;
            }
            this.setY = function(Y) {
                this.y = Y;
            }
            this.setWidth = function(WIDTH) {
                this.width = WIDTH;
            }
            this.setHeight = function(HEIGHT) {
                this.height = HEIGHT
            }
            this.setValue = function(VALUE) {
                this.value = VALUE;
            }
            this.setColor = function(COLOR) {
                this.color = COLOR;
            }
            this.getX = function() {
                return this.x;
            }
            this.getY = function() {
                return this.y;
            }
            this.getWidth = function() {
                return this.width;
            }
            this.getHeight = function() {
                return this.height;
            }
            this.getValue = function() {
                return this.value;
            }
            this.getColor = function() {
                return this.color;
            }
            this.drawRectangle = function() {
                canvasContext.fillStyle = this.color;
                canvasContext.fillRect(this.x, this.y, this.width, this.height);
                canvasContext.fillStyle = "black";
                var textWidth=canvasContext.measureText(this.value).width;
                if (this.value || this.value == 0) canvasContext.fillText(this.value, this.x + (this.width)/2-textWidth/2, this.y + (this.height) / 2);
                //here this.x+10 where 10 is act as margin
            }
        }
        var rectangles = [];
        var originalRectangles = [];
        var canvas;
        var canvasContext;
        var x = 10;
        var rectangleWidth = 50;
        var spaceBetweenRectangle = 3;
        var rectanglesColor = '#8BBEE6FF';
        var highlightingColor = '#CDE2B8';
        var swapHappern = -1;
        var sorting = [];
        var validate = false;
        var checkIfComplete = false;
        var animationSpeed = 1;
        var pause=false;
        var stop=false;
        var pausedValues={};
        var swapTimeout;
        var bubbleSortTimeout;
        var drawCanvasFooterTimeout;
        window.onload = function() {
            canvas = document.getElementById("myCanvas");
            canvasContext = canvas.getContext("2d");
            setCreateMode();
            var noeInput = document.getElementById("createArrayTextField");
            noeInput.addEventListener("keyup", function(event) {
                if (event.keyCode == 13) {
                    event.preventDefault();
                    if (validate) CreateElements();
                }
            });
            var noeInput2 = document.getElementById("valueOfElementTextField");
            noeInput2.addEventListener("keyup", function(event) {
                if (event.keyCode == 13) {
                    event.preventDefault();
                    if (validate) AddElement();

                }
            });
        }

        function setCreateMode() {
            var createArrayTextField = document.getElementById("createArrayTextField");
            createArrayTextField.value = "";
            createArrayTextField.focus();
            createArrayTextField.style.display = "block";
            document.getElementById("valueOfElementTextField").style.display = "none";
            document.getElementById("sortButton").style.display = "none";
            document.getElementById("sortButton").style.display="none";
            document.getElementById("playButton").style.display="none";
            document.getElementById("pauseButton").style.display="none";
            document.getElementById("stopButton").style.display="none";
            document.getElementById("pauseSpan").style.visibility="visible";
            document.getElementById("pauseSpan").innerHTML="";
            document.getElementById("myRange").disabled=false;
        }

        function setAddMode() {
            var valueOfElementTextField = document.getElementById("valueOfElementTextField");
            valueOfElementTextField.value = "";
            document.getElementById("createArrayTextField").style.display = "none";
            document.getElementById("valueOfElementTextField").style.display = "block";
            document.getElementById("sortButton").style.display = "none";
            valueOfElementTextField.focus();
        }

        function setSortMode() {
            var sortButton = document.getElementById("sortButton");
            sortButton.value = "";
            document.getElementById("resetButton").disabled = true;
            document.getElementById("createArrayTextField").style.display = "none";
            document.getElementById("valueOfElementTextField").style.display = "none";
            document.getElementById("sortButton").style.display = "block";
            sortButton.focus();
        }
        function setSortingMode()
        {
            document.getElementById("sortButton").style.display="none";
            document.getElementById("playButton").style.display="none";
            document.getElementById("pauseButton").style.display="inline";
            document.getElementById("stopButton").style.display="inline";
            document.getElementById("myRange").disabled=true;
        }
        function setPauseMode()
        {
            pause=true;
            document.getElementById("myRange").disabled=false;
            document.getElementById("sortButton").style.display = "none";
            document.getElementById("playButton").style.display = "inline";
            document.getElementById("pauseButton").style.display = "none";
            document.getElementById("stopButton").style.display = "inline";
            document.getElementById("pauseSpan").innerHTML="Paused !";
        }
        function setPausingMode()
        {
            pause=true;
            document.getElementById("pauseSpan").innerHTML="Pausing";
            document.getElementById("pauseButton").style.display="none";
        }
        function setPauseValues(fk,i,j,textIndex,r1,r2)
        {
            //function key values
            //10 -> bubbleSort function
            //20 -> drawCanvasFooter function
            //30 -> swapAnimation
            pausedValues["functionKey"]=fk;
            pausedValues["i"]=i;
            pausedValues["j"]=j;
            pausedValues["textIndex"]=textIndex;
            pausedValues["rectangle1"]=r1;
            pausedValues["rectangle2"]=r2;
            // console.log(pausedValues);
        }
        function setPlayMode()
        {
            pause=false;
            document.getElementById("sortButton").style.display = "none";
            document.getElementById("playButton").style.display = "none";
            document.getElementById("pauseButton").style.display = "inline";
            document.getElementById("stopButton").style.display = "inline";
            document.getElementById("pauseSpan").innerHTML="";
            document.getElementById("myRange").disabled=true;
            // pausedValues={};
        }
        function setFinishedMode()
        {
            document.getElementById("sortButton").style.display = "none";
            document.getElementById("playButton").style.display = "none";
            document.getElementById("pauseButton").style.display = "none";
            document.getElementById("stopButton").style.display = "none";
            document.getElementById("statusSpan").innerHTML="Finished !";
        }
        function setStoppingMode()
        {
            pause=true;
            stop=true;
            document.getElementById("pauseSpan").innerHTML="Stopping";
            document.getElementById("sortButton").style.display = "none";
            document.getElementById("playButton").style.display = "none";
            document.getElementById("pauseButton").style.display = "none";
            document.getElementById("stopButton").style.display = "none";
            document.getElementById("myRange").disabled=true;
        }
        function draw() {
            canvasContext.font = "20px arial";
            canvasContext.clearRect(0, 0, canvas.width, canvas.height);
            canvasContext.fillText("Input Array", 10, 20);
            if (sorting.length != 0 && !checkIfComplete) canvasContext.fillText("Sorting", 10, 130);
            if (sorting.length != 0 && checkIfComplete) canvasContext.fillText("Sorted Array", 10, 130);
            for (var i = 0; i <= originalRectangles.length - 1; i++) {
                originalRectangles[i].drawRectangle();
                canvasContext.font = "10px arial";
                canvasContext.fillText(i, originalRectangles[i].x + (originalRectangles[i].width) / 2, originalRectangles[i].y + originalRectangles[i].height + 12);
                canvasContext.font = "20px arial";
                if (rectangles.length == originalRectangles.length) {
                    canvasContext.font = "10px arial";
                    canvasContext.fillText(i, rectangles[i].x + (rectangles[i].width) / 2, rectangles[i].y + rectangles[i].height + 12);
                    canvasContext.font = "20px arial";
                    rectangles[i].drawRectangle();
                }
            }
            if (!(typeof drawLineX == 'undefined') && sorting.length!=0) drawConnectingLine();
            // if (sorting.length != 0) setTimeout(drawCanvasFooter(),10000);
            if (sorting.length != 0) drawLimitLine();
        }

        function drawConnectingLine() {
            if (checkIfComplete) return;
            r1 = rectangles[sorting[1]];
            // console.log("connecting line function chala");
            canvasContext.beginPath();
            canvasContext.setLineDash([0, 0]);
            canvasContext.moveTo(drawLineX + (r1.width) / 2, 225);
            canvasContext.lineTo(drawLineX + (r1.width) / 2, 250);
            canvasContext.stroke();
            canvasContext.beginPath();
            canvasContext.moveTo(drawLineX + (r1.width) / 2, 250);
            canvasContext.lineTo(drawLineX + (r1.width) / 2 + r1.width + 5, 250);
            canvasContext.stroke();
            canvasContext.beginPath();
            canvasContext.moveTo(drawLineX + (r1.width) / 2 + r1.width + 5, 250);
            canvasContext.lineTo(drawLineX + (r1.width) / 2 + r1.width + 5, 225);
            canvasContext.stroke();
        }

        function drawLimitLine() {
            if (checkIfComplete) return;
            canvasContext.font = "12px arial";
            canvasContext.setLineDash([5, 3]);
            canvasContext.beginPath();
            canvasContext.strokeStyle = "red";
            if (sorting[0] != rectangles.length - 1) canvasContext.moveTo(10 + (rectangles[sorting[1]].width + 3) * (rectangles.length - sorting[0]), 147);
            else canvasContext.moveTo(10 + (rectangles[sorting[1]].width + 3) * (rectangles.length - sorting[0] + 1), 147);

            if (sorting[0] != rectangles.length - 1) canvasContext.lineTo(10 + (rectangles[sorting[1]].width + 3) * (rectangles.length - sorting[0]), 220);
            else canvasContext.lineTo(10 + (rectangles[sorting[1]].width + 3) * (rectangles.length - sorting[0] + 1), 220);
            canvasContext.stroke();
            canvasContext.strokeStyle = "black";
            if (sorting[0] != rectangles.length - 1) canvasContext.fillText("LIMIT", 10 + (rectangles[sorting[1]].width + 3) * (rectangles.length - sorting[0]) - (canvasContext.measureText("LIMIT").width) / 2, 145);
            else canvasContext.fillText("LIMIT", 10 + (rectangles[sorting[1]].width + 3) * (rectangles.length - sorting[0] + 1) - (canvasContext.measureText("LIMIT").width) / 2, 145);
            canvasContext.font = "20px arial";
        }
        function styledFill(string, textx, texty,style,color) {
            if(style) canvasContext.font =style;
            else canvasContext.font="20px arial";
            if(color) canvasContext.fillStyle=color;
            else canvasContext.fillStyle="black";
            canvasContext.fillText(string, textx, texty);
            canvasContext.font = "20px arial";
            canvasContext.fillStyle="black";
            return textx+canvasContext.measureText(string).width;
        }

        function checkAnswer(j) {   
            if (rectangles[j].value > rectangles[j + 1].value) return "Swapping the values of index "+j+" and "+parseInt(j+1);
            else return "No Swapping is required";
        }

        function checkSign(j) {
            if (rectangles[j].value < rectangles[j + 1].value) return "not greater than";
            else if (rectangles[j].value > rectangles[j + 1].value) return "greater than";
            else return "not greater than";
        }

        function checkDimension() {
            if (canvas.width < x) {
                canvas.width = canvas.width + rectangleWidth + spaceBetweenRectangle;
            }
            draw();
        }

        function CreateElements() {
            canvasContext.clearRect(0, 0, canvas.width, canvas.height);
            var numberOfElements = document.getElementById("createArrayTextField");
            // console.log(numberOfElements.value);
            for (var i = 0; i <= numberOfElements.value - 1; i++) {
                var r = new Rectangle();
                r.setX(x);
                r.drawRectangle();
                x = x + rectangleWidth + spaceBetweenRectangle;
                checkDimension();
                originalRectangles.push(r);
             }
            draw();
            setAddMode();
        }

        function AddElement() {
            var v = document.getElementById("valueOfElementTextField");
            if (v.value.length == 0) return
            var createArrayTextField = document.getElementById("createArrayTextField");
            //here we check widt h of our text and check that is font is overflow
            var textWidth = canvasContext.measureText(v.value).width;
            // console.log(textWidth);
            if (textWidth + 10 > rectangleWidth) {
                var difference = textWidth - rectangleWidth + 10
                    // console.log(difference);
                rectangleWidth = rectangleWidth + (difference);
                // console.log(rectangleWidth);
                x = 10;
                for (var i = 0; i <= createArrayTextField.value - 1; i++) {
                    originalRectangles[i].setX(x);
                    originalRectangles[i].drawRectangle();
                    originalRectangles[i].width = rectangleWidth;
                    x = x + rectangleWidth + spaceBetweenRectangle;
                    checkDimension();
                }
                draw();
            }
            for (var i = 0; i <= originalRectangles.length - 1; i++) {
                if (!(originalRectangles[i].value || originalRectangles[i].value == 0)) break;
            }
            if (i > originalRectangles.length) {
                // alert("more numbers than expected");
                document.getElementById("addElementErrorSpan").innerHTML = "Size limit exceeded";
                return;
            }
            // console.log(textWidth);
            originalRectangles[i].value = parseInt(v.value);
            originalRectangles[i].drawRectangle();
            if (i == originalRectangles.length - 1) {
                setSortMode();
                return;
            }
            setAddMode();
            v.placeholder = "Enter value of index " + parseInt(i + 1);
        }

        function SortElement() {
            // document.getElementById("myRange").disabled=true;
            setSortingMode();
            makeSortingElements();
            bubbleSort();
            draw();
        }

        function makeSortingElements() {
            for (var i = 0; i <= originalRectangles.length - 1; i++) {
                var m = originalRectangles[i];
                var r = new Rectangle();
                r.setX(m.getX());
                r.setY(150);
                r.setValue(m.getValue());
                rectangles.push(r);
            }
            draw();
        }
        function bubbleSort(playI,playJ) {
            var i,j;
            if(playI) i=playI;
            else i=0;
            if(playJ) j=playJ;
            else j=0;
            var length = rectangles.length;

            (function nextIteration() {
                if (j >= length - i - 1) {
                    releaseAllColor();
                    j = 0;
                    i++;
                }
                if (i < length) {
                    // console.log(pausedValues["functionKey"]==undefined);
                    // console.log("pause is "+pause);
                    if(pause){
                        clearTimeout(drawCanvasFooterTimeout);
                        clearTimeout(swapTimeout);
                        clearTimeout(bubbleSortTimeout);
                        if(!stop) setPauseMode();
                        setPauseValues(10,i,j,0,rectangles[j],rectangles[j+1]);
                        return;
                    }
                    sorting = [i, j];
                    drawLineX = rectangles[j].x; //we use it for draw connecting lines
                    draw();
                    drawConnectingLine();
                    releaseAllColor();
                    changeColor(j);
                    drawCanvasFooter(i,j);

                    bubbleSortTimeout=setTimeout(function(){
                        j++;
                        nextIteration();
                    },(animationSpeed>0 && animationSpeed<1)?20000*animationSpeed:15000*(animationSpeed/2));
                    // bubbleSortTimeout=setTimeout(function()
                    // {
                    //     swap(i,j);
                    //     j++;
                    //     swapTimeout=setTimeout(nextIteration,(animationSpeed>0 && animationSpeed<1)?1000:3000);
                    // },(animationSpeed>0 && animationSpeed<1)?20000*animationSpeed:15000*(animationSpeed/2));
                } else {
                    releaseAllColor();
                    checkIfComplete = true;
                    draw();
                    setFinishedMode();                 
                }
            })();
        }
        function drawCanvasFooter(i,j,textIndex)
        {
            var index;
            if(textIndex) index=textIndex;
            else index=1;
            if(checkIfComplete) return;
            (function test2()
            {
            console.log("drawCanvasFooter chala"+index);
                // console.log(index);
                if(pause){
                    clearTimeout(drawCanvasFooterTimeout);
                    clearTimeout(swapTimeout);
                    clearTimeout(bubbleSortTimeout);
                    if(!stop) setPauseMode();
                    setPauseValues(20,i,j,index,rectangles[j],rectangles[j+1]);
                    return;
                }
                var textx=20;
                var texty=300;
                var str="";
                var typingEffect;
                if(index==1)
                {
                    str=" Comparing the values of index "+sorting[1]+" and index "+parseInt(sorting[1]+1);
                    canvasContext.clearRect(10,250,canvas.width,500);
                    typingEffect=new TypingEffect(canvasContext);
                    typingEffect.makeTypingEffect(textx,texty,str,23*animationSpeed);
                }
                if(index==2)
                {
                    canvasContext.clearRect(20,250,canvas.width,500);
                    var str="The value at index "+sorting[1]+" is "+rectangles[sorting[1]].value+" and the value at index "+parseInt(sorting[1]+1)+" is "+rectangles[sorting[1]+1].value;
                    typingEffect=new TypingEffect(canvasContext);
                    typingEffect.makeTypingEffect(textx,texty,str,23*animationSpeed);
                }
                if(index==3)
                {
                    canvasContext.clearRect(20,250,canvas.width,500);
                    str="Since "+rectangles[sorting[1]].value+" is "+checkSign(sorting[1])+" "+rectangles[sorting[1]+1].value;
                    typingEffect=new TypingEffect(canvasContext);
                    typingEffect.makeTypingEffect(textx,texty,str,23*animationSpeed);
                }
                if(index==4)
                {
                    canvasContext.clearRect(20,250,canvas.width,500);
                    str="Therefore, "+checkAnswer(sorting[1]);
                    typingEffect=new TypingEffect(canvasContext);
                    typingEffect.makeTypingEffect(textx,texty,str,23*animationSpeed);
                }
                // console.log("good");
                if(index==5)
                {
                        swap(i,j);
                        index++;
                }
                index++;
                if(index<6){
                    // console.log(index);
                    var drawCanvasFooterTimeout=setTimeout(test2,(animationSpeed>0 && animationSpeed<1)?3000*(animationSpeed):3000*(animationSpeed/2));
                }
                if(pausedValues["functionKey"]!=undefined && index>5)
                {
                    // console.log("hissle");
                    setTimeout(function(){
                        bubbleSort(pausedValues["i"],pausedValues["j"]+1);
                        pausedValues={};
                    },(animationSpeed<0 && animationSpeed>1)?3000:6000);
                }

            })();
            // console.log("index is "+index);

        }
        function swap(i,j) {
            if (rectangles[j].value > rectangles[j + 1].value) {
                swapRectangle(i,j);
                swapHappern = 1;
            } else {
                swapHappern = 2;
            }
        }

        function changeColor(j) {
            // console.log("good");
            rectangles[j].color = highlightingColor;
            rectangles[j + 1].color = highlightingColor;
            draw();
        }

        function releaseColor(j) {
            // console.log("bad");
            rectangles[j].color = rectanglesColor;
            rectangles[j + 1].color = rectanglesColor;
            draw();
        }

        function releaseAllColor() {
            for (var i = 0; i <= rectangles.length - 1; i++) {
                rectangles[i].color = rectanglesColor;
            }
        }
        var myVar;

        function swapRectangle(i,j) {
            currVariable1 = rectangles[j].getX();
            currVariable2 = rectangles[j + 1].getX();

            myVar = setInterval(swapAnimation, 10 * animationSpeed, rectangles[j], rectangles[j + 1],i,j);
        }

        function swapAnimation(r1, r2,i,j) {
            r1.setX(r1.getX() + 1);
            r2.setX(r2.getX() - 1);
            draw();
            if ((currVariable1 > r2.getX()) && (currVariable2 < r1.getX())) {
                r1.x = currVariable1;
                r2.x = currVariable2;
                var tmp = r1.value;
                r1.value = r2.value;
                r2.value = tmp;
                r1.drawRectangle();
                r2.drawRectangle();
                clearInterval(myVar);
                swapHappern = -1;
            }
        }

        function reset() {
            location.reload();
        }

        function changeSpeed() {
            var speed = 1;
            animationSpeed=1;
            speed = document.getElementById("myRange").value;
            speed = (-1) * speed;
            // console.log(speed);
            if (speed > 0) animationSpeed = animationSpeed * speed;
            if (speed < 0) animationSpeed = (-1) * (animationSpeed / speed);
            if (speed==0) animationSpeed=1;
            console.log(animationSpeed);
        }
        function playAnimation()
        {
            // console.log("playAnimation chala");
            // console.log(pausedValues["functionKey"]);
            // console.log(animationSpeed);
            setPlayMode();
            if(pausedValues["functionKey"]==10)
            {
              bubbleSort(pausedValues["i"],pausedValues["j"]);
            }
            if(pausedValues["functionKey"]==20)
            {
                drawCanvasFooter(pausedValues["i"],pausedValues["j"],pausedValues["textIndex"]);
            }

        } 
        function pauseAnimation()
        {
            setPausingMode();
        }
        function stopAnimation()
        {
            clearTimeout(swapTimeout);
            clearTimeout(bubbleSortTimeout);
            clearTimeout(drawCanvasFooterTimeout);
            // setPausingMode();
            setStoppingMode();
            setTimeout(function(){
            canvasContext.clearRect(0,0,canvas.width,canvas.height);
            rectangles = [];
            originalRectangles = [];
            // canvas;
            // canvasContext;
            x = 10;
            rectangleWidth = 50;
            spaceBetweenRectangle = 3;
            rectanglesColor = '#8BBEE6FF';
            highlightingColor = '#CDE2B8';
            swapHappern = -1;
            sorting = [];
            validate = false;
            checkIfComplete = false;
            animationSpeed = 1;
            pause=false;
            stop=false;
            pausedValues={};
            setCreateMode();
            },5000);
        }
    </script>
</head>

<body>
    <div class="jumbotron text-center w-100 p-3">
        <div style="float: right;">
            <img class="img-fluid" src="images/reset.png" id="resetButton" onclick="reset()" width="40" height="40">
        </div>
        <h1>Bubble Sort Visualization</h1>
    </div>
    <div class="container-fluid">
        <span class="badge badge-pill badge-info" id="pauseSpan"></span>
        <div class="slidecontainer">
            Speed&nbsp;
            <input type="range" min="-5" max="5" value="1" class="slider" id="myRange" onclick='changeSpeed();'>
        </div>
        <br>
        <br>
        <center>
            <div style="max-height: 600px;max-width: width window;overflow: scroll;">
                <canvas id="myCanvas" width="1300px" height="450px" style="background-color: #fbfbfb69"></canvas>
            </div>
            <br>
            <span class="invalidText" id="errorSpan"></span>
            <input placeholder="Enter size of array ( value more than 1 )" class="form-control" type="text" id="createArrayTextField" style="border-radius: 50px;background-color: #f8f8f8;width: 500px; height:40px;font-size: 15pt;padding-left:15px;" oninput="checkSizeOfArrayOnInput()">
            <input placeholder="Enter value of index 0" class="form-control" type="text" id="valueOfElementTextField" style="border-radius: 50px;background-color: #f8f8f8;width: 500px; height:40px;font-size: 15pt;padding-left:15px;" oninput="checkValueOfElementsOnInput()">
            <button type="button" id='sortButton' class="btn btn-outline-secondary" onclick='SortElement();' style="width:100px;">Sort</button><br>
            <h3><span class="badge badge-pill badge-success" id="statusSpan"></span></h3>
            <img class="img-fluid more" src="images/play.png" id="playButton" onclick="playAnimation()" width="50" height="50" style="display: none;">
            <img class="img-fluid more" src="images/pause.png" id="pauseButton" onclick="pauseAnimation()" width="50" height="50" style="display: none;">
            <img class="img-fluid more" src="images/stop.png" id="stopButton" onclick="stopAnimation()" width="50" height="50" style="display: none;">
            </center>

    </div>
     <!-- <script type="text/javascript" src="js/bootstrap.min.js"></script>
     <script type="text/javascript" src="js/jquery.min.js"></script>
     <script type="text/javascript" src="js/popper.min.js"></script>
 -->
</body>

</html>